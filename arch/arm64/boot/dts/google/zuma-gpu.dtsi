// SPDX-License-Identifier: GPL-2.0-only
/*
 * ZUMA Mali GPU  device tree source
 *
 * Copyright 2022 Google LLC
 *
 */

/ {
	mali_mgm: physical-memory-group-manager {
		compatible = "arm,physical-memory-group-manager";
		pt_id = "GPU";
	};

	mali_pma: protected-memory-allocator {
		compatible = "arm,protected-memory-allocator";
	};

	mali: mali@1F000000 {
		compatible = "arm,malit6xx";
		reg = <0x0 0x1F000000 0x1000000>;
		l2-hash-values = <0x0036DB6D 0x005B6DB6 0x0>;
		interrupts =
			<GIC_SPI IRQ_G3D_IRQJOB_G3D IRQ_TYPE_LEVEL_HIGH>,
			<GIC_SPI IRQ_G3D_IRQMMU_G3D IRQ_TYPE_LEVEL_HIGH>,
			<GIC_SPI IRQ_G3D_IRQGPU_G3D IRQ_TYPE_LEVEL_HIGH>;
		interrupt-names = "JOB", "MMU", "GPU";

		/* Power */
		power-domains = <&pd_g3d>, <&pd_embedded_g3d>;
		power-domain-names = "top", "cores";
		g3d_genpd_name = "pd-embedded_g3d";
		gpu_pmu_status_reg_offset = <0x1C84>;
		gpu_pmu_status_local_pwr_mask = <0x1>; /*0x1 << 0*/
		gpu_pm_autosuspend_delay = <500>;
		power_policy = "adaptive";

		/* Memory */
		physical-memory-group-manager = <&mali_mgm>;

		/* Protected memory allocator */
		protected-memory-allocator = <&mali_pma>;

		/* Clocks */
		gpu0_cmu_cal_id = <ACPM_DVFS_G3DL2>;
		gpu1_cmu_cal_id = <ACPM_DVFS_G3D>;

		/* DVFS */
		gpu_dvfs_governor = "quickstep";
		gpu_dvfs_clockdown_hysteresis = <50>;

		/* DVFS operating points */
		gpu_dvfs_table_size_v1 = <12 10>; /*<row col>*/
		gpu_dvfs_table_v1 = <
			/*
			 *gpu0    gpu1   down     up    hys      int      mif   little  middle   big
			 * clk     clk   util   util  ticks      min      min      min     min   max
			 *--------------------------------------------------------------------------
			 */
			900000  890000     85    100      1        0        0        0       0     0
			900000  807000     81     97      1        0        0        0       0     0
			900000  723000     76     94      1        0        0        0       0     0
			749000  649000     85     96      2        0        0        0       0     0
			749000  580000     83     97      3        0        0        0       0     0
			659000  521000     78     95      3        0        0        0       0     0
			659000  467000     80     96      3        0        0        0       0     0
			531000  419000     76     95      3        0        0        0       0     0
			531000  376000     72     94      3        0        0        0       0     0
			430000  337000     67     94      2        0        0        0       0     0
			386000  302000     50     92      1        0        0        0       0     0
			160000  150000      0     90      1        0        0        0       0     0
		>;
		/* DVFS step up value */
		gpu_dvfs_step_up_val = <3>;

		/* DVFS Level locks */
		gpu_dvfs_max_freq = <900000>;
		gpu_dvfs_min_freq = <0>;

		/* QOS */
		gpu_dvfs_qos_bts_scenario = "g3d_performance";
		gpu_dvfs_qos_bts_threshold = <400000>;

		/* Thermal */
		#cooling-cells = <2>;
		gpu_power_coeff = <625>;
		ect-coeff-index = <3>;
	};
};
